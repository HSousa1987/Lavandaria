<testsuites id="" name="" tests="12" failures="5" skipped="0" errors="0" time="37.863364999999995">
<testsuite name="rbac-and-sessions.spec.js" timestamp="2025-10-27T21:18:25.584Z" hostname="chromium" tests="12" failures="5" skipped="0" time="30.603" errors="0">
<testcase name="RBAC - Finance Access Restrictions › worker cannot access finance routes" classname="rbac-and-sessions.spec.js" time="3.76">
<system-out>
<![CDATA[✅ Worker blocked from /api/payments with correlation ID: req_1761599910491_skygw921v
✅ Worker blocked from /api/dashboard with correlation ID: req_1761599910503_dahtxhecg

[[ATTACHMENT|rbac-and-sessions-RBAC---F-7849d-annot-access-finance-routes-chromium/test-finished-1.png]]

[[ATTACHMENT|rbac-and-sessions-RBAC---F-7849d-annot-access-finance-routes-chromium/video.webm]]

[[ATTACHMENT|rbac-and-sessions-RBAC---F-7849d-annot-access-finance-routes-chromium/trace.zip]]
]]>
</system-out>
</testcase>
<testcase name="RBAC - Finance Access Restrictions › admin can access finance routes" classname="rbac-and-sessions.spec.js" time="3.026">
<failure message="rbac-and-sessions.spec.js:63:5 admin can access finance routes" type="FAILURE">
<![CDATA[  [chromium] › rbac-and-sessions.spec.js:63:5 › RBAC - Finance Access Restrictions › admin can access finance routes 

    Error: expect(received).not.toBe(expected) // Object.is equality

    Expected: not 403

      76 |
      77 |         // Should succeed (200) or return data (not 403)
    > 78 |         expect(response.status()).not.toBe(403);
         |                                       ^
      79 |     });
      80 |
      81 |     test('master can access all routes', async ({ page, request }) => {
        at /Applications/XAMPP/xamppfiles/htdocs/Lavandaria/tests/e2e/rbac-and-sessions.spec.js:78:39

    attachment #1: screenshot (image/png) ──────────────────────────────────────────────────────────
    ../../test-results/rbac-and-sessions-RBAC---F-f0364-n-can-access-finance-routes-chromium/test-failed-1.png
    ────────────────────────────────────────────────────────────────────────────────────────────────

    attachment #2: video (video/webm) ──────────────────────────────────────────────────────────────
    ../../test-results/rbac-and-sessions-RBAC---F-f0364-n-can-access-finance-routes-chromium/video.webm
    ────────────────────────────────────────────────────────────────────────────────────────────────

    Error Context: ../../test-results/rbac-and-sessions-RBAC---F-f0364-n-can-access-finance-routes-chromium/error-context.md

    attachment #4: trace (application/zip) ─────────────────────────────────────────────────────────
    ../../test-results/rbac-and-sessions-RBAC---F-f0364-n-can-access-finance-routes-chromium/trace.zip
    Usage:

        npx playwright show-trace ../../test-results/rbac-and-sessions-RBAC---F-f0364-n-can-access-finance-routes-chromium/trace.zip

    ────────────────────────────────────────────────────────────────────────────────────────────────
]]>
</failure>
<system-out>
<![CDATA[
[[ATTACHMENT|rbac-and-sessions-RBAC---F-f0364-n-can-access-finance-routes-chromium/test-failed-1.png]]

[[ATTACHMENT|rbac-and-sessions-RBAC---F-f0364-n-can-access-finance-routes-chromium/video.webm]]

[[ATTACHMENT|rbac-and-sessions-RBAC---F-f0364-n-can-access-finance-routes-chromium/error-context.md]]

[[ATTACHMENT|rbac-and-sessions-RBAC---F-f0364-n-can-access-finance-routes-chromium/trace.zip]]
]]>
</system-out>
</testcase>
<testcase name="RBAC - Finance Access Restrictions › master can access all routes" classname="rbac-and-sessions.spec.js" time="3.293">
<failure message="rbac-and-sessions.spec.js:81:5 master can access all routes" type="FAILURE">
<![CDATA[  [chromium] › rbac-and-sessions.spec.js:81:5 › RBAC - Finance Access Restrictions › master can access all routes 

    Error: expect(received).not.toBe(expected) // Object.is equality

    Expected: not 403

      93 |         for (const route of FINANCE_ROUTES) {
      94 |             const response = await request.get(route);
    > 95 |             expect(response.status()).not.toBe(403);
         |                                           ^
      96 |         }
      97 |     });
      98 | });
        at /Applications/XAMPP/xamppfiles/htdocs/Lavandaria/tests/e2e/rbac-and-sessions.spec.js:95:43

    attachment #1: screenshot (image/png) ──────────────────────────────────────────────────────────
    ../../test-results/rbac-and-sessions-RBAC---F-e93c5-aster-can-access-all-routes-chromium/test-failed-1.png
    ────────────────────────────────────────────────────────────────────────────────────────────────

    attachment #2: video (video/webm) ──────────────────────────────────────────────────────────────
    ../../test-results/rbac-and-sessions-RBAC---F-e93c5-aster-can-access-all-routes-chromium/video.webm
    ────────────────────────────────────────────────────────────────────────────────────────────────

    Error Context: ../../test-results/rbac-and-sessions-RBAC---F-e93c5-aster-can-access-all-routes-chromium/error-context.md

    attachment #4: trace (application/zip) ─────────────────────────────────────────────────────────
    ../../test-results/rbac-and-sessions-RBAC---F-e93c5-aster-can-access-all-routes-chromium/trace.zip
    Usage:

        npx playwright show-trace ../../test-results/rbac-and-sessions-RBAC---F-e93c5-aster-can-access-all-routes-chromium/trace.zip

    ────────────────────────────────────────────────────────────────────────────────────────────────
]]>
</failure>
<system-out>
<![CDATA[
[[ATTACHMENT|rbac-and-sessions-RBAC---F-e93c5-aster-can-access-all-routes-chromium/test-failed-1.png]]

[[ATTACHMENT|rbac-and-sessions-RBAC---F-e93c5-aster-can-access-all-routes-chromium/video.webm]]

[[ATTACHMENT|rbac-and-sessions-RBAC---F-e93c5-aster-can-access-all-routes-chromium/error-context.md]]

[[ATTACHMENT|rbac-and-sessions-RBAC---F-e93c5-aster-can-access-all-routes-chromium/trace.zip]]
]]>
</system-out>
</testcase>
<testcase name="RBAC - Staff Route Restrictions › client cannot access staff routes" classname="rbac-and-sessions.spec.js" time="3.317">
<system-out>
<![CDATA[✅ Client blocked from /api/users with status 403
✅ Client blocked from /api/clients with status 403

[[ATTACHMENT|rbac-and-sessions-RBAC---S-dfd55--cannot-access-staff-routes-chromium/test-finished-1.png]]

[[ATTACHMENT|rbac-and-sessions-RBAC---S-dfd55--cannot-access-staff-routes-chromium/video.webm]]

[[ATTACHMENT|rbac-and-sessions-RBAC---S-dfd55--cannot-access-staff-routes-chromium/trace.zip]]
]]>
</system-out>
</testcase>
<testcase name="RBAC - Staff Route Restrictions › unauthenticated user cannot access protected routes" classname="rbac-and-sessions.spec.js" time="0.215">
<failure message="rbac-and-sessions.spec.js:132:5 unauthenticated user cannot access protected routes" type="FAILURE">
<![CDATA[  [chromium] › rbac-and-sessions.spec.js:132:5 › RBAC - Staff Route Restrictions › unauthenticated user cannot access protected routes 

    Error: expect(received).toBe(expected) // Object.is equality

    Expected: 401
    Received: 403

      143 |             const response = await page.request.get(route);
      144 |
    > 145 |             expect(response.status()).toBe(401);
          |                                       ^
      146 |             const result = await response.json();
      147 |
      148 |             expect(result).toHaveProperty('error');
        at /Applications/XAMPP/xamppfiles/htdocs/Lavandaria/tests/e2e/rbac-and-sessions.spec.js:145:39

    attachment #1: screenshot (image/png) ──────────────────────────────────────────────────────────
    ../../test-results/rbac-and-sessions-RBAC---S-542a0-not-access-protected-routes-chromium/test-failed-1.png
    ────────────────────────────────────────────────────────────────────────────────────────────────

    attachment #2: trace (application/zip) ─────────────────────────────────────────────────────────
    ../../test-results/rbac-and-sessions-RBAC---S-542a0-not-access-protected-routes-chromium/trace.zip
    Usage:

        npx playwright show-trace ../../test-results/rbac-and-sessions-RBAC---S-542a0-not-access-protected-routes-chromium/trace.zip

    ────────────────────────────────────────────────────────────────────────────────────────────────
]]>
</failure>
<system-out>
<![CDATA[
[[ATTACHMENT|rbac-and-sessions-RBAC---S-542a0-not-access-protected-routes-chromium/test-failed-1.png]]

[[ATTACHMENT|rbac-and-sessions-RBAC---S-542a0-not-access-protected-routes-chromium/trace.zip]]
]]>
</system-out>
</testcase>
<testcase name="Session Behavior › session persists across page reloads" classname="rbac-and-sessions.spec.js" time="3.888">
<system-out>
<![CDATA[
[[ATTACHMENT|rbac-and-sessions-Session--c940b-ersists-across-page-reloads-chromium/test-finished-1.png]]

[[ATTACHMENT|rbac-and-sessions-Session--c940b-ersists-across-page-reloads-chromium/video.webm]]

[[ATTACHMENT|rbac-and-sessions-Session--c940b-ersists-across-page-reloads-chromium/trace.zip]]
]]>
</system-out>
</testcase>
<testcase name="Session Behavior › session check endpoint returns user info" classname="rbac-and-sessions.spec.js" time="3.076">
<failure message="rbac-and-sessions.spec.js:181:5 session check endpoint returns user info" type="FAILURE">
<![CDATA[  [chromium] › rbac-and-sessions.spec.js:181:5 › Session Behavior › session check endpoint returns user info 

    Error: expect(received).toHaveProperty(path, value)

    Expected path: "success"

    Expected value: true
    Received value: false

      195 |
      196 |         const result = await response.json();
    > 197 |         expect(result).toHaveProperty('success', true);
          |                        ^
      198 |         expect(result).toHaveProperty('data');
      199 |         expect(result.data).toHaveProperty('authenticated', true);
      200 |         expect(result.data).toHaveProperty('userType', 'admin');
        at /Applications/XAMPP/xamppfiles/htdocs/Lavandaria/tests/e2e/rbac-and-sessions.spec.js:197:24

    attachment #1: screenshot (image/png) ──────────────────────────────────────────────────────────
    ../../test-results/rbac-and-sessions-Session--9629c--endpoint-returns-user-info-chromium/test-failed-1.png
    ────────────────────────────────────────────────────────────────────────────────────────────────

    attachment #2: video (video/webm) ──────────────────────────────────────────────────────────────
    ../../test-results/rbac-and-sessions-Session--9629c--endpoint-returns-user-info-chromium/video.webm
    ────────────────────────────────────────────────────────────────────────────────────────────────

    Error Context: ../../test-results/rbac-and-sessions-Session--9629c--endpoint-returns-user-info-chromium/error-context.md

    attachment #4: trace (application/zip) ─────────────────────────────────────────────────────────
    ../../test-results/rbac-and-sessions-Session--9629c--endpoint-returns-user-info-chromium/trace.zip
    Usage:

        npx playwright show-trace ../../test-results/rbac-and-sessions-Session--9629c--endpoint-returns-user-info-chromium/trace.zip

    ────────────────────────────────────────────────────────────────────────────────────────────────
]]>
</failure>
<system-out>
<![CDATA[
[[ATTACHMENT|rbac-and-sessions-Session--9629c--endpoint-returns-user-info-chromium/test-failed-1.png]]

[[ATTACHMENT|rbac-and-sessions-Session--9629c--endpoint-returns-user-info-chromium/video.webm]]

[[ATTACHMENT|rbac-and-sessions-Session--9629c--endpoint-returns-user-info-chromium/error-context.md]]

[[ATTACHMENT|rbac-and-sessions-Session--9629c--endpoint-returns-user-info-chromium/trace.zip]]
]]>
</system-out>
</testcase>
<testcase name="Session Behavior › logout clears session and denies access" classname="rbac-and-sessions.spec.js" time="3.317">
<failure message="rbac-and-sessions.spec.js:205:5 logout clears session and denies access" type="FAILURE">
<![CDATA[  [chromium] › rbac-and-sessions.spec.js:205:5 › Session Behavior › logout clears session and denies access 

    Error: expect(received).toBeTruthy()

    Received: false

      216 |         // Verify authenticated
      217 |         const beforeLogout = await request.get('/api/cleaning-jobs');
    > 218 |         expect(beforeLogout.ok()).toBeTruthy();
          |                                   ^
      219 |
      220 |         // Logout (with standardized envelope)
      221 |         const logoutResponse = await request.post('/api/auth/logout');
        at /Applications/XAMPP/xamppfiles/htdocs/Lavandaria/tests/e2e/rbac-and-sessions.spec.js:218:35

    attachment #1: screenshot (image/png) ──────────────────────────────────────────────────────────
    ../../test-results/rbac-and-sessions-Session--eb090-s-session-and-denies-access-chromium/test-failed-1.png
    ────────────────────────────────────────────────────────────────────────────────────────────────

    attachment #2: video (video/webm) ──────────────────────────────────────────────────────────────
    ../../test-results/rbac-and-sessions-Session--eb090-s-session-and-denies-access-chromium/video.webm
    ────────────────────────────────────────────────────────────────────────────────────────────────

    Error Context: ../../test-results/rbac-and-sessions-Session--eb090-s-session-and-denies-access-chromium/error-context.md

    attachment #4: trace (application/zip) ─────────────────────────────────────────────────────────
    ../../test-results/rbac-and-sessions-Session--eb090-s-session-and-denies-access-chromium/trace.zip
    Usage:

        npx playwright show-trace ../../test-results/rbac-and-sessions-Session--eb090-s-session-and-denies-access-chromium/trace.zip

    ────────────────────────────────────────────────────────────────────────────────────────────────
]]>
</failure>
<system-out>
<![CDATA[
[[ATTACHMENT|rbac-and-sessions-Session--eb090-s-session-and-denies-access-chromium/test-failed-1.png]]

[[ATTACHMENT|rbac-and-sessions-Session--eb090-s-session-and-denies-access-chromium/video.webm]]

[[ATTACHMENT|rbac-and-sessions-Session--eb090-s-session-and-denies-access-chromium/error-context.md]]

[[ATTACHMENT|rbac-and-sessions-Session--eb090-s-session-and-denies-access-chromium/trace.zip]]
]]>
</system-out>
</testcase>
<testcase name="Session Behavior › concurrent sessions from different users work independently" classname="rbac-and-sessions.spec.js" time="6.447">
<system-out>
<![CDATA[
[[ATTACHMENT|rbac-and-sessions-Session--8d7af-nt-users-work-independently-chromium/test-finished-2.png]]

[[ATTACHMENT|rbac-and-sessions-Session--8d7af-nt-users-work-independently-chromium/test-finished-1.png]]

[[ATTACHMENT|rbac-and-sessions-Session--8d7af-nt-users-work-independently-chromium/trace.zip]]
]]>
</system-out>
</testcase>
<testcase name="Health and Readiness Endpoints › health endpoint returns 200 without authentication" classname="rbac-and-sessions.spec.js" time="0.015">
<system-out>
<![CDATA[
[[ATTACHMENT|rbac-and-sessions-Health-a-89c71--200-without-authentication-chromium/trace.zip]]
]]>
</system-out>
</testcase>
<testcase name="Health and Readiness Endpoints › readiness endpoint returns database status" classname="rbac-and-sessions.spec.js" time="0.016">
<system-out>
<![CDATA[
[[ATTACHMENT|rbac-and-sessions-Health-a-67343-int-returns-database-status-chromium/trace.zip]]
]]>
</system-out>
</testcase>
<testcase name="Health and Readiness Endpoints › health and readiness are public (no auth required)" classname="rbac-and-sessions.spec.js" time="0.233">
<system-out>
<![CDATA[
[[ATTACHMENT|rbac-and-sessions-Health-a-8e71d-re-public-no-auth-required--chromium/test-finished-1.png]]

[[ATTACHMENT|rbac-and-sessions-Health-a-8e71d-re-public-no-auth-required--chromium/trace.zip]]
]]>
</system-out>
</testcase>
</testsuite>
</testsuites>